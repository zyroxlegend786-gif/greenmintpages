<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Green Pages</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;
  font-family:Arial;
  background:#020617;
  color:white;
}
.container{
  max-width:400px;
  margin:50px auto;
  padding:20px;
  background:#0f172a;
  border-radius:10px;
}
input,button{
  width:100%;
  padding:10px;
  margin:8px 0;
  border:none;
  border-radius:6px;
}
input{background:#1e293b;color:white;}
button{
  background:#16a34a;
  color:white;
  cursor:pointer;
}
button:hover{opacity:0.8;}
#dashboard{display:none;}
.file-box{
  background:#1e293b;
  padding:10px;
  border-radius:6px;
  margin-top:10px;
}
</style>
</head>
<body>

<div class="container" id="authBox">
<h2>Green Pages</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button onclick="signup()">Sign Up</button>
<button onclick="login()">Login</button>
</div>

<div class="container" id="dashboard">
<h2>Dashboard</h2>
<p id="userEmail"></p>
<input type="file" id="fileInput">
<button onclick="uploadFile()">Upload File</button>
<button onclick="logout()">Logout</button>
<div id="status"></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getStorage, ref, uploadBytes } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyBJ-Ki5RueLv0_JatYBaoEatlZS4WD9ZMY",
  authDomain: "greenpages-cc200.firebaseapp.com",
  databaseURL: "https://greenpages-cc200-default-rtdb.firebaseio.com",
  projectId: "greenpages-cc200",
  storageBucket: "greenpages-cc200.firebasestorage.app",
  messagingSenderId: "939676595663",
  appId: "1:939676595663:web:39fe97fe23f31bebcd4eba"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const storage = getStorage();

window.signup = function(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  createUserWithEmailAndPassword(auth,email,password)
  .then(()=>alert("Signup Success"))
  .catch(e=>alert(e.message));
}

window.login = function(){
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  signInWithEmailAndPassword(auth,email,password)
  .catch(e=>alert(e.message));
}

window.logout = function(){
  signOut(auth);
}

onAuthStateChanged(auth,(user)=>{
  if(user){
    document.getElementById("authBox").style.display="none";
    document.getElementById("dashboard").style.display="block";
    document.getElementById("userEmail").innerText="Logged in as: "+user.email;
  }else{
    document.getElementById("authBox").style.display="block";
    document.getElementById("dashboard").style.display="none";
  }
});

window.uploadFile = function(){
  const file = document.getElementById("fileInput").files[0];
  if(!file) return alert("Select file first");

  const user = auth.currentUser;
  const storageRef = ref(storage, "sites/"+user.uid+"/"+file.name);

  uploadBytes(storageRef,file).then(()=>{
    document.getElementById("status").innerHTML=
    "<div class='file-box'>Uploaded: "+file.name+"</div>";
  });
}

</script>

</body>
</html>
